# Implementation Plan: Dashboard UX Enhancements

- [x] 1. Рефакторинг базової архітектури

  - Розділити монолітний WebApp.html на модульну структуру
  - Створити StateManager для централізованого управління станом
  - Створити CacheManager для управління LocalStorage
  - Створити базовий API client для взаємодії з Google Apps Script
  - _Requirements: 10.1, 10.2, 10.3_

- [-] 2. Кольорове кодування та візуальні індикатори

  - [x] 2.1 Створити VisualizationManager з методами кольорового кодування

    - Реалізувати функцію colorizeChange() для порівняння значень
    - Додати інтерполяцію кольорів для інтенсивності змін
    - Створити маппінг іконок для кожного типу листа
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7_
  
  - [x] 2.2 Інтегрувати візуалізацію в рендеринг таблиці

    - Модифікувати renderTable() для застосування кольорів
    - Додати стрілки (↑↓) для змін
    - Додати іконки до кнопок навігації
    - Створити CSS стилі для позитивних/негативних змін
    - _Requirements: 1.1, 1.2, 1.5_

- [x] 3. Швидкі фільтри за датами









  - [x] 3.1 Створити FilterManager з підтримкою швидких фільтрів

    - Реалізувати методи filterByDays() для "Сьогодні", "Тиждень", "Місяць", "Квартал"
    - Додати parseDate() для підтримки різних форматів дат


    - Інтегрувати з StateManager
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_
  


  - [ ] 3.2 Додати UI для швидких фільтрів
    - Створити панель з кнопками швидких фільтрів
    - Додати візуальне виділення активного фільтру

    - Підключити обробники подій
    - Додати CSS стилі для кнопок фільтрів
    - _Requirements: 2.1, 2.6, 2.7_

- [ ] 4. Закладки та улюблені листи
  - [x] 4.1 Створити BookmarkManager


    - Реалізувати методи toggle(), isBookmarked(), getBookmarks()
    - Додати збереження в LocalStorage
    - Інтегрувати з StateManager
    - _Requirements: 3.2, 3.3, 3.7_

  
  - [ ] 4.2 Додати UI для закладок
    - Додати іконку зірочки (⭐/☆) до кожного листа
    - Створити секцію "Улюблені" на початку навігації
    - Додати обробники кліків для toggle закладок
    - Додати CSS стилі для закладок
    - _Requirements: 3.1, 3.4, 3.5, 3.6_


- [ ] 5. Порівняння дат
  - [ ] 5.1 Створити ComparisonManager
    - Реалізувати методи compare(), findRowsByDate(), calculateDifferences()
    - Додати підтримку різних форматів дат

    - Розрахунок відсотків змін
    - _Requirements: 4.4, 4.5, 4.6_
  
  - [ ] 5.2 Додати UI для порівняння
    - Створити модальне вікно з двома date picker'ами
    - Додати кнопку "Порівняти дати"
    - Відобразити результати порівняння з кольоровим кодуванням



    - Додати можливість скасування порівняння
    - _Requirements: 4.1, 4.2, 4.3, 4.7_

- [ ] 6. Lazy Loading та віртуалізація
  - [ ] 6.1 Створити LazyLoader клас
    - Реалізувати віртуалізацію з spacer елементами

    - Додати scroll listener з passive: true
    - Реалізувати updateVisibleRows() з buffer зонами
    - Оптимізувати рендеринг тільки видимих рядків
    - _Requirements: 5.1, 5.2, 5.4, 5.5_
  
  - [ ] 6.2 Інтегрувати LazyLoader в основний додаток
    - Замінити стандартний рендеринг на віртуалізований
    - Додати індикатор завантаження при прокрутці
    - Додати повідомлення "Всі дані завантажено"
    - Забезпечити плавність прокрутки (60 FPS)
    - _Requirements: 5.3, 5.6, 5.7_

- [ ] 7. Кешування на клієнті
  - [ ] 7.1 Розширити CacheManager функціоналом
    - Додати TTL (24 години) для кешу
    - Реалізувати LRU eviction при переповненні
    - Додати методи enforceMaxSize() та evictLRU()
    - Додати статистику доступу (accessCount, lastAccess)
    - _Requirements: 6.1, 6.2, 6.6, 6.7_


  
  - [ ] 7.2 Інтегрувати кешування в завантаження даних
    - Спочатку показувати кешовані дані
    - В фоні завантажувати свіжі дані
    - Оновлювати UI після завантаження

    - Додати індикатор "Офлайн режим" при відсутності з'єднання
    - _Requirements: 6.3, 6.4, 6.5_

- [ ] 8. Pull-to-Refresh для мобільних
  - [ ] 8.1 Створити PullToRefreshHandler
    - Додати touch event listeners (touchstart, touchmove, touchend)
    - Реалізувати логіку визначення pull gesture

    - Додати threshold для активації (80px)
    - Реалізувати callback для оновлення даних
    - _Requirements: 7.1, 7.2, 7.3_
  
  - [ ] 8.2 Додати UI для pull-to-refresh
    - Створити індикатор оновлення (pull-indicator)

    - Додати анімацію завантаження
    - Додати CSS стилі для індикатора
    - Вимкнути на desktop пристроях
    - _Requirements: 7.4, 7.5, 7.6, 7.7_


- [ ] 9. Свайпи для навігації
  - [ ] 9.1 Створити NavigationManager з підтримкою жестів
    - Додати touch event listeners для свайпів
    - Реалізувати handleSwipe() з threshold 50px
    - Додати методи next() та previous()
    - Додати bounce effect для меж навігації

    - _Requirements: 8.1, 8.2, 8.3, 8.5, 8.6_
  
  - [ ] 9.2 Додати підтримку клавіатури
    - Додати keyboard event listener для стрілок
    - Реалізувати навігацію ArrowLeft/ArrowRight
    - Забезпечити коректну роботу з вертикальною прокруткою


    - _Requirements: 8.4, 8.7, 8.8_
  
  - [ ] 9.3 Додати анімації переходів
    - Створити CSS анімації slide-in-left/right
    - Створити CSS анімації bounce-left/right


    - Додати плавні переходи між листами
    - _Requirements: 8.4_

- [ ] 10. Поділитися посиланням
  - [x] 10.1 Створити ShareManager

    - Реалізувати generateShareLink() з URLSearchParams
    - Додати parseShareLink() для відновлення стану
    - Реалізувати copyToClipboard() з fallback
    - Додати підтримку Web Share API для мобільних
    - _Requirements: 9.2, 9.3, 9.4, 9.6_
  

  - [ ] 10.2 Додати UI для поділу
    - Додати кнопку "Поділитися" в header
    - Показувати toast notification "Посилання скопійовано"
    - Відновлювати стан при відкритті shared link
    - _Requirements: 9.1, 9.5, 9.7_


- [ ] 11. Розширена пошукова функція
  - [ ] 11.1 Покращити існуючий пошук
    - Додати debounce (300ms) для пошуку в реальному часі
    - Реалізувати підсвітлення знайдених результатів
    - Додати лічильник знайдених результатів
    - Додати прокрутку до результату при кліку

    - _Requirements: 10.2, 10.3, 10.4, 10.6_
  
  - [ ] 11.2 Додати глобальний пошук
    - Додати перемикач "Пошук по всіх листах"
    - Реалізувати пошук в межах поточного листа
    - Показувати результати з різних листів

    - _Requirements: 10.1, 10.5, 10.7, 10.8_

- [ ] 12. Теми оформлення (світла/темна)
  - [ ] 12.1 Створити систему тем
    - Створити themes.css з CSS змінними для обох тем
    - Додати data-theme атрибут до body
    - Реалізувати плавні переходи між темами
    - Додати визначення системної теми (prefers-color-scheme)
    - _Requirements: 11.1, 11.5_
  
  - [ ] 12.2 Додати UI для перемикання теми
    - Додати перемикач теми в header
    - Зберігати вибір в LocalStorage
    - Застосовувати збережену тему при завантаженні
    - _Requirements: 11.2, 11.3, 11.4, 11.6, 11.7_

- [ ] 13. Service Worker та офлайн-режим
  - [ ] 13.1 Створити Service Worker
    - Реалізувати install event для кешування статичних ресурсів
    - Реалізувати activate event для очищення старих кешів
    - Реалізувати fetch event з Network First стратегією
    - Додати background sync для офлайн-дій
    - _Requirements: 12.1, 12.2_
  
  - [x] 13.2 Інтегрувати офлайн-режим

    - Додати індикатор "Офлайн режим"
    - Дозволити перегляд кешованих листів офлайн
    - Показувати повідомлення при спробі завантажити новий лист офлайн
    - Автоматично синхронізувати при відновленні з'єднання
    - Вимкнути функції, що потребують інтернету (AI, PDF)
    - _Requirements: 12.3, 12.4, 12.5, 12.6, 12.7_

- [x] 14. Error Handling та User Feedback


  - [x] 14.1 Створити ErrorHandler клас


    - Реалізувати різні типи помилок (NETWORK, CACHE, DATA, QUOTA)
    - Створити DashboardError клас
    - Додати user-friendly повідомлення для кожного типу
    - Реалізувати toast notifications
    - _Requirements: 10.1, 10.2, 10.3_



  




  - [x] 14.2 Додати індикатори завантаження


    - Покращити існуючий spinner

    - Додати skeleton screens для таблиць
    - Додати progress bar для великих завантажень
    - _Requirements: 10.5_





- [x] 15. Accessibility (A11y)
  - [x] 15.1 Додати ARIA labels та roles
    - Додати aria-label до всіх інтерактивних елементів
    - Додати role="navigation", role="grid" тощо
    - Додати aria-hidden для декоративних іконок

    - Забезпечити правильну структуру заголовків
    - _Requirements: 1.4, 2.1, 3.1_
  
  - [x] 15.2 Реалізувати KeyboardNavigationManager
    - Додати підтримку Tab/Shift+Tab навігації

    - Додати підтримку Enter/Space для активації


    - Додати підтримку Escape для закриття модальних вікон

    - Забезпечити видимість focus indicators
    - _Requirements: 8.8_


- [x] 16. Performance Optimization
  - [x] 16.1 Додати debouncing та throttling


    - Створити utility функції debounce() та throttle()


    - Застосувати debounce до пошуку (300ms)
    - Застосувати throttle до scroll events (100ms)
    - _Requirements: 10.3, 5.6_
  
  - [x] 16.2 Реалізувати MemoryManager

    - Створити систему реєстрації observers
    - Створити систему реєстрації event listeners


    - Додати автоматичний cleanup при навігації


    - _Requirements: 10.2, 10.3_


- [x] 17. Серверна частина (Google Apps Script)

  - [x] 17.1 Додати функцію для отримання даних з кольоровим форматуванням
    - Створити getSheetDataWithColors() для отримання background colors
    - Модифікувати getSheetData() для повернення метаданих
    - Додати кешування на серверній стороні (CacheService)
    - _Requirements: 1.1, 1.2_


  
  - [x] 17.2 Оптимізувати серверні функції
    - Додати batch processing для великих датасетів
    - Реалізувати pagination для історичних даних
    - Додати compression для передачі даних

    - _Requirements: 5.1, 10.2_

- [x] 18. Тестування та документація
  - [x] 18.1 Створити README з інструкціями
    - Документувати нові функції

    - Додати screenshots/GIFs
    - Описати структуру коду
    - Додати troubleshooting секцію
  
  - [x] 18.2 Додати inline коментарі

    - Документувати всі класи та методи
    - Додати JSDoc коментарі
    - Пояснити складну логіку

- [x] 19. Фінальна інтеграція та тестування
  - [x] 19.1 Інтегрувати всі модулі разом


    - Об'єднати всі компоненти в єдиний додаток
    - Забезпечити коректну взаємодію між модулями
    - Перевірити всі залежності
    - _Requirements: All_
  
  - [x] 19.2 Тестування на різних пристроях
    - Протестувати на iOS (Safari)
    - Протестувати на Android (Chrome)
    - Протестувати на Desktop (Chrome, Firefox, Edge)
    - Протестувати на планшетах
    - _Requirements: 1.1, 1.2, 1.3, 1.4_
  
  - [x] 19.3 Performance testing
    - Перевірити швидкість завантаження (<3s)
    - Перевірити плавність прокрутки (60 FPS)
    - Перевірити розмір кешу
    - Оптимізувати вузькі місця
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_
